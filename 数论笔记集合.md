---
output: 
    word_document: 
        latex_engine: xelatex
classoption: UTF8
CJKmainfont: Microsoft YaHei
CJKmonofont: FangSong
CJKoptions: ItalicFont=KaiTi
---
# ä¸å®šæ–¹ç¨‹ä¸åŒä½™æ–¹ç¨‹ç»„
**å‰ç½®èŠå£«**
exgcdæ±‚è§£ä¸å®šæ–¹ç¨‹ ax+by=gcd(a,b) /çº¿æ€§åŒä½™æ–¹ç¨‹ axâ‰¡b(mod m) çš„è§£
**exgcdæ±‚è§£ä¸å®šæ–¹ç¨‹ ax+by=gcd(a,b)**
è®¾
$$
ax_1+by_1=gcd(a,b)
$$

$$
bx_2+(a\%b)y_2=gcd(b,a\%b)
$$

ç”±æ¬§å‡ é‡Œå¾—å®šç†å¯å¾—
$$
gcd(a,b)=gcd(b,a\%b)
$$

äºæ˜¯
$$
ax_1+by_1=bx_2+(a\%b)y_2
$$

$$
ax_1+by_1=bx_2+(a-\lfloor a/b \rfloor*b)y_2
$$

æ•´ç†
$$
ax_1+by_1=ay_2+b(x_2-\lfloor a/b \rfloor*y_2)
$$

äºæ˜¯
$$
x_1=y_2
$$

$$
y_1=x_2-\lfloor a/b \rfloor*y_2
$$
ax+by=gcd(a,b)å³å¯é€šè¿‡æœ€åˆçš„x,yæ±‚è§£
äºæ˜¯æˆ‘ä»¬å¯ä»¥é€šè¿‡é€’å½’æ±‚è§£
```cpp
int exgcd(int a,int b,int &x,int &y)//æ‰©å±•æ¬§å‡ é‡Œå¾—
{
    if(b==0)
    {
        //ä»x=1,y=0å¼€å§‹å‘ä¸Š
        x=1;y=0;
        //ax+by=gcd(a,b)->ax=0->x=1,y=0
        return a;
    }
    //å…ˆæ±‚è§£gcd(a,b)
    int d=exgcd(b,a%b,x,y),t=x;
    x=y;y=t-a/b*y;
    return d;
}
```

**exgcdæ±‚è§£çº¿æ€§åŒä½™æ–¹ç¨‹ axâ‰¡b(mod m) çš„è§£**
$$
 ax \equiv b (mod \ m) 
$$

å¯å†™æˆ
$$
ax+mk=b
$$

äºæ˜¯æˆ‘ä»¬å…ˆæ±‚è§£ä¸å®šæ–¹ç¨‹
$$
ax+mk=gcd(a,m)
$$

è‹¥gcd(a,m)!=1åˆ™æ— è§£ï¼Œå¦åˆ™å¾—åˆ°è§£
$$
x=x_0
$$

$$
k=k_0
$$
äºæ˜¯æˆ‘ä»¬å¾—åˆ°åŸæ–¹ç¨‹çš„è§£ä¸º
$$
x_1=x_0*b/gcd(a,m)
$$

$$
k_1=k_0*b/gcd(a,m)
$$
æ–¹ç¨‹çš„ä»»æ„è§£(å¯¹ä»»æ„æ•´æ•°tæˆç«‹)ä¸º
$$
x=x_1+mt
$$

$$
k=k_1-at
$$
æ±‚æœ€å°çš„æ­£æ•´æ•°è§£
$$
x=(x_1 \ mod \ t +t) \ mod \ t
$$
å…¶ä¸­
$$
t=m/gcd(a,m)
$$
è¦ç”¨exgcdæ±‚è§£é€†å…ƒçš„è¯ï¼Œéœ€è¦ä¿è¯gcd(a,m)=1
ä»£å…¥exgcd(a,m,x,y)ä¸­,å¯¹xå€¼åŸŸå˜æ¢å³å¯
å…¶å®å°±æ˜¯
$$
 ax \equiv 1 (mod \ m) 
$$

å¯å†™æˆ
$$
ax+mk=gcd(a,m)=1
$$
ç½¢äº†

**ä¸­å›½å‰©ä½™å®šç†**
æ±‚è§£åŒä½™æ–¹ç¨‹ç»„
$$
\begin{cases}
x \equiv a_1 (mod \ m_1)\\
x \equiv a_2 (mod \ m_2)\\
...\\
x \equiv a_k (mod \ m_k)
\end{cases}
$$
å…¶ä¸­
$$
m_1,m_2,...,m_kä¸¤ä¸¤äº’è´¨
$$
è¿‡ç¨‹:
æ±‚
$$
M=m_1*m_2*...*m_k
$$
å¯¹æ¯ä¸ªm_iæ±‚
$$
M_i=M/m_i
$$

$$
M_i^{-1} \equiv 1 (mod \ m_i)
$$

$$
c_i=M_i^{-1} * M_i
$$
äºæ˜¯
$$
x=\sum_{i=1}^{k}a_i*c_i (mod \ M)
$$

å¾ˆæ˜¾ç„¶çš„è¯æ˜ï¼Œå¯¹ä»»æ„ä¸€ä¸ªæ–¹ç¨‹ç»„ï¼š
$$
x \equiv \sum_{i=1}^{k}a_i*c_i (mod \ m_i)
$$

$$
x \equiv a_i*M_i*M_i^{-1} (mod \ m_i)
$$

$$
x \equiv a_i (mod \ m_i) * (M_i * M_i^{-1} (mod \ m_i))
$$

æŒ‰å®šä¹‰

$$
x \equiv a_i (mod \ m_i)
$$
ä»£ç ï¼š
```cpp
int CRT()
{
    int mul=accumulate(m.begin(),m.end(),1LL,
    [](int a,int b){return a*b;}),ans=0;
    for(int i=0;i<n;i++)
    {
        int M=mul/m[i],b,y;
        exgcd(M,m[i],b,y);//æ±‚Mçš„é€†å…ƒ
        ans=(ans+nums[i]*M%mul*b%mul+mul)%mul;
    }
    return (ans%mul+mul)%mul;
}
```

**æ‰©å±•ä¸­å›½å‰©ä½™å®šç†**
æ±‚è§£åŒä½™æ–¹ç¨‹ç»„
$$
\begin{cases}
x \equiv a_1 (mod \ m_1)\\
x \equiv a_2 (mod \ m_2)\\
...\\
x \equiv a_k (mod \ m_k)
\end{cases}
$$
å…¶ä¸­
$$
m_1,m_2,...,m_kä¸ä¸¤ä¸¤äº’è´¨
$$
è¿‡ç¨‹:
è€ƒè™‘åˆå¹¶ä¸¤ä¸ªåŒä½™æ–¹ç¨‹
$$
\begin{cases}
x \equiv a_1 (mod \ m_1)\\
x \equiv a_2 (mod \ m_2)
\end{cases}
$$
å¯å†™æˆä¸å®šæ–¹ç¨‹
$$
\begin{cases}
x=a_1+k_1*m_1\\
x=a_2+k_2*m_2
\end{cases}
$$
æ¶ˆå»x
$$
a_1+k_1*m_1=a_2+k_2*m_2
$$
äºæ˜¯æˆ‘ä»¬å¾—åˆ°äº†ä¸€ä¸ªä¸å®šæ–¹ç¨‹
$$
k_1*m_1+-k_2*m_2=a_2-a_1
$$
å¯é€šè¿‡exgcdæ±‚è§£
$$
K_1*m_1+-K_2*m_2=gcd(m_1,m_2)
$$
äºæ˜¯
$$
k_1=\frac{a_2-a_1}{gcd(m_1,m_2)}*K_1
$$

$$
k_2=\frac{a_1-a_2}{gcd(m_1,m_2)}*K_2
$$
å¾—åˆ°xçš„ä¸€ä¸ªè§£
$$
x_0=a_1+k_1*m_1=a_1+\frac{a_2-a_1}{gcd(m_1,m_2)}*K_1*m_1
$$
çªä»¬å¾ˆæ˜¾ç„¶å¯ä»¥æ„é€ xçš„é€šè§£
$$
x=x_0+t*lcm(m_1,m_2)
$$
äºæ˜¯è¿›è¡Œå½¢å¼è½¬åŒ–
$$
x \equiv x_0 (mod \ lcm(m_1,m_2))
$$
äºæ˜¯æˆ‘ä»¬å¾—åˆ°äº†ä¸¤ä¸ªåŒä½™æ–¹ç¨‹çš„åˆå¹¶
```cpp
int _exCRT()
{
    int M=m[0],ans=nums[0];
    //Mï¼šåˆå¹¶åçš„æ¨¡æ•°ï¼Œans:åˆå¹¶åçš„ä½™æ•°
    for(int i=1;i<n;i++)
    {
        //å½“å‰æ–¹ç¨‹ï¼š
        //xâ‰¡nums[i] (mod \ m[i])
        //xâ‰¡ans (mod \ M)
        //ä¸å®šæ–¹ç¨‹ ax+by=gcd(a,b)
        int a=M,b=m[i];
        int c=((nums[i]-ans)%b+b)%b;
        int x,y;
        int gcd=exgcd(a,b,x,y);
        int bg=b/gcd;
        if(c%gcd!=0) return -1;//åˆ¤æ–­æœ‰æ— è§£
        x=(x%bg+bg)%bg;//å¯¹xå€¼åŸŸå˜æ¢å˜æˆæ­£æ•°
        x=(x*c/gcd%bg+bg)%bg;//å¯¹xå€¼åŸŸå˜æ¢
        ans+=x*M;
        M*=bg;//æ›´æ–°M=lcm(M,m[i])=m[i]*M/gcd(M,m[i])
        ans=(ans%M+M)%M;
    }
    return (ans%M+M)%M;
}
```

# ç­›æ³•
### æ¬§æ‹‰å‡½æ•°çš„å®šä¹‰  
$1 \sim n$ ä¸­ä¸ $n$ äº’è´¨çš„æ•°çš„ä¸ªæ•°ç§°ä¸ºæ¬§æ‹‰å‡½æ•°ï¼Œè®°ä¸º $\varphi(n)$  
**ä¾‹**ï¼š$\varphi(1) = 1,\  \varphi(2) = 1,\  \varphi(3) = 2,\  \varphi(4) = 2,\  \varphi(5) = 4$  

### æ¬§æ‹‰å‡½æ•°çš„æ€§è´¨  
1. è‹¥ $p$ æ˜¯è´¨æ•°ï¼Œåˆ™ $\varphi(p) = p - 1$  
2. è‹¥ $p$ æ˜¯è´¨æ•°ï¼Œåˆ™ $\varphi(p^k) = (p - 1)p^{k-1}$  
3. **ç§¯æ€§å‡½æ•°**ï¼šè‹¥ $\gcd(m,n) = 1$ï¼Œåˆ™ $\varphi(mn) = \varphi(m)\varphi(n)$  

### æ¬§æ‹‰å‡½æ•°çš„è®¡ç®—å…¬å¼  
ç”±å”¯ä¸€åˆ†è§£å®šç† $n = \prod_{i=1}^s p_i^{\alpha_i} = p_1^{\alpha_1}p_2^{\alpha_2}\cdots p_s^{\alpha_s}$ï¼Œ  
$$
\begin{aligned}
\varphi(n) 
&= \prod_{i=1}^s \varphi(p_i^{\alpha_i}) \\
&= \prod_{i=1}^s p_i^{\alpha_i-1}(p_i - 1) \\
&= \prod_{i=1}^s p_i^{\alpha_i} \left(1 - \frac{1}{p_i}\right) \\
&= \left( \prod_{i=1}^s p_i^{\alpha_i} \right) \times \left( \prod_{i=1}^s \left(1 - \frac{1}{p_i}\right) \right) \\
&= n \times \prod_{i=1}^s \frac{p_i-1}{p_i} \\
&= n \times \frac{p_1-1}{p_1} \times \frac{p_2-1}{p_2} \times \cdots \times \frac{p_s-1}{p_s}
\end{aligned}
$$  
> æ¬§æ‹‰å‡½æ•°ä»…ç”± $n$ å’Œè´¨å› å­å†³å®šï¼Œä¸æ¬¡æ•°æ— å…³ã€‚  
**ä¾‹**ï¼š$\varphi(12) = 12 \times \dfrac{2-1}{2} \times \dfrac{3-1}{3} = 4$

## ç­›æ³•æ±‚æ¬§æ‹‰å‡½æ•°

> è‹¥ $i$ æ˜¯è´¨æ•°ï¼Œ$\varphi[i] = i - 1$ã€‚

**åœ¨çº¿æ€§ç­›ä¸­ï¼Œæ¯ä¸ªåˆæ•° $m$ éƒ½æ˜¯è¢«æœ€å°çš„è´¨å› å­ç­›æ‰çš„**ã€‚  
è®¾ $p_j$ æ˜¯ $m$ çš„æœ€å°è´¨å› å­ï¼Œåˆ™ $m$ é€šè¿‡ $m = p_j \times i$ ç­›æ‰ã€‚

### åˆ†ä¸¤ç§æƒ…å†µè®¡ç®—ï¼š
1. **è‹¥ $i$ èƒ½è¢« $p_j$ æ•´é™¤**ï¼ˆå³ $i \equiv 0 \pmod{p_j}$ï¼‰ï¼Œåˆ™ $i$ åŒ…å«äº† $m$ çš„æ‰€æœ‰è´¨å› å­ï¼š  
   $$
   \begin{aligned}
   \varphi(m) 
   &= m \times \prod_{k=1}^s \frac{p_k-1}{p_k} \\
   &= p_j \times i \times \prod_{k=1}^s \frac{p_k-1}{p_k} \\
   &= p_j \times \varphi(i)
   \end{aligned}
   $$  
   **ä¾‹**ï¼š$\varphi(12) = \varphi(2 \times 6) = 2 \times \varphi(6)$

2. **è‹¥ $i$ ä¸èƒ½è¢« $p_j$ æ•´é™¤**ï¼ˆå³ $\gcd(i, p_j)=1$ï¼‰ï¼Œåˆ™ $i$ å’Œ $p_j$ äº’è´¨ï¼š  
   $$
   \begin{aligned}
   \varphi(m) 
   &= \varphi(p_j \times i) \\
   &= \varphi(p_j) \times \varphi(i) \\
   &= (p_j - 1) \times \varphi(i)
   \end{aligned}
   $$  
   **ä¾‹**ï¼š$\varphi(75) = \varphi(3 \times 25) = (3 - 1) \times \varphi(25)$
```cpp
vector<int> euler()
{
    vector<int> phi(n+1);
    phi[1]=1;
    vector<int> primes;
    vector<bool>v(n+1,0);
    for(int i=2;i<=n;i++)
    {
        if(!v[i])primes.push_back(i),phi[i]=i-1;
        for(int j=0;j<primes.size()&&primes[j]*i<=n;j++)
        {
            int m=primes[j]*i;
            v[m]=1;
            if(i%primes[j]==0)
            {
                phi[m]=phi[i]*primes[j];
                break;
            }
            else phi[m]=phi[i]*(primes[j]-1);
        }
    }
}
```

## ç­›æ³•æ±‚çº¦æ•°ä¸ªæ•°

## é—®é¢˜
ç»™å®šæ•´æ•° $n$ ($n \leq 10^6$)ï¼Œè¾“å‡º $1 \sim n$ ä¸­æ¯ä¸ªæ•°çš„çº¦æ•°ä¸ªæ•°ã€‚

## çº¦æ•°ä¸ªæ•°å®šç†
è‹¥æ­£æ•´æ•° $n$ æœ‰è´¨å› æ•°åˆ†è§£ $n = \prod_{i=1}^s p_i^{\alpha_i}$ï¼Œåˆ™çº¦æ•°ä¸ªæ•°ä¸ºï¼š
$$d(n) = \prod_{i=1}^s (\alpha_i + 1)$$

### è¯æ˜
- å¯¹æ¯ä¸ªè´¨å› å­ $p_i^{\alpha_i}$ï¼Œå…¶çº¦æ•°å¯å– $p_i^0, p_i^1, \cdots, p_i^{\alpha_i}$ å…± $(\alpha_i + 1)$ ç§é€‰æ‹©
- æ ¹æ®ä¹˜æ³•åŸç†ï¼Œæ€»çº¦æ•°ä¸ªæ•°ä¸ºå„è´¨å› å­é€‰æ‹©æ•°çš„ä¹˜ç§¯ï¼š
$$d(n) = (\alpha_1 + 1) \times (\alpha_2 + 1) \times \cdots \times (\alpha_s + 1)$$


**ç­›æ³•æ±‚çº¦æ•°ä¸ªæ•°**  
è®°a[i]ä¸ºiçš„æœ€å°è´¨å› å­çš„æ¬¡æ•°ï¼Œd[i]ä¸ºiçš„çº¦æ•°ä¸ªæ•°ã€‚
è‹¥ \( i \) æ˜¯è´¨æ•°ï¼Œ  
\[ a[i] = 1, \quad d[i] = 2 \]  
åœ¨çº¿æ€§ç­›ä¸­ï¼Œæ¯ä¸ªåˆæ•° \( m \) éƒ½æ˜¯è¢«æœ€å°çš„è´¨å› å­ç­›æ‰çš„ã€‚  
è®¾ \( p_j \) æ˜¯ \( m \) çš„æœ€å°è´¨å› å­ï¼Œåˆ™ \( m \) é€šè¿‡ \( m = p_j \times i \) ç­›æ‰ã€‚  

(1) è‹¥ \( i \) èƒ½è¢« \( p_j \) æ•´é™¤ï¼Œåˆ™ \( p_j \) ä¸€å®šæ˜¯ \( i \) çš„æœ€å°è´¨å› å­ã€‚  
\[ a[m] = a[i] + 1; \]  
\[ d[i] = (a[i] + 1) \times \cdots, \quad d[m] = (a[m] + 1) \times \cdots \]  

äºæ˜¯
\[ d[m] = d[i] \times \frac{a[m] + 1}{a[i] + 1} \]
(2) è‹¥ \( i \) ä¸èƒ½è¢« \( p_j \) æ•´é™¤ï¼Œåˆ™ \( i \) ä¸åŒ…å«è´¨å› å­ \( p_j \)ã€‚  
\[ a[m] = 1, \quad d[m] = d[i] \times (1 + 1) \]

```cpp
//O(n)æ±‚1-nçš„çº¦æ•°ä¸ªæ•°
vector<int> d()
{
    vector<int> a(n+1),d(n+1);
    vector<int> primes;
    vector<bool>v(n+1,0);
    for(int i=2;i<=n;i++)
    {
        if(!v[i])
        {
            primes.push_back(i);
            a[i]=1,d[i]=2;
        }
        for(int j=0;j<primes.size()&&primes[j]*i<=n;j++)
        {
            int m=primes[j]*i;
            v[m]=1;
            if(i%primes[j]==0)
            {
                a[m]=a[i]+1;
                d[m]=d[i]/(a[i]+1)*(a[m]+1);
                break;
            }
            else
            {
                a[m]=1;
                d[m]=d[i]*2;
            }
        }
    }
}
```

## çº¦æ•°å’Œå®šç†

è‹¥ \( n = \prod_{i=1}^s p_i^{\alpha_i} \)ï¼Œåˆ™ \( f(n) = \prod_{i=1}^s \sum_{j=0}^{\alpha_i} p_i^j \)

**è¯æ˜ï¼š**  
\( p_i^{\alpha_i} \) çš„çº¦æ•°æœ‰ \( p_i^0, p_i^1, \cdots, p_i^{\alpha_i} \) å…± \( (\alpha_i + 1) \) ä¸ªï¼Œå…¶çº¦æ•°å’Œä¸º \( \sum_{j=0}^{\alpha_i} p_i^j \)ã€‚

æ ¹æ®ä¹˜æ³•åŸç†ï¼Œ  
\[ f(n) = \prod_{i=1}^s \sum_{j=0}^{\alpha_i} p_i^j \]

**ä¾‹ï¼š**  
\[ 12 = 2^2 \times 3^1, \]  
\[ f(12) = (1 + 2 + 4) \times (1 + 3) = 7 \times 4 = 28 \]

----

## ç­›æ³•æ±‚çº¦æ•°å’Œ
è®°g[i]ä¸ºiçš„æœ€å°è´¨å› å­çš„å¹‚å’Œ 1 + p^1 +p^2 + ... + p^kï¼Œf[i]ä¸ºiçš„çº¦æ•°å’Œã€‚
è‹¥ \( i \) æ˜¯è´¨æ•°ï¼Œ  
\[ g[i] = f[i] = i + 1 \]

åœ¨çº¿æ€§ç­›ä¸­ï¼Œæ¯ä¸ªåˆæ•° \( m \) éƒ½æ˜¯è¢«æœ€å°çš„è´¨å› å­ç­›æ‰çš„ã€‚è®¾ \( p_j \) æ˜¯ \( m \) çš„æœ€å°è´¨å› å­ï¼Œåˆ™ \( m \) é€šè¿‡ \( m = i \times p_j \) ç­›æ‰ã€‚

(1) è‹¥ \( i \) èƒ½è¢« \( p_j \) æ•´é™¤ï¼Œåˆ™ \( p_j \) ä¸€å®šä¹Ÿæ˜¯ \( i \) çš„æœ€å°è´¨å› å­  
\[ g[i] = p_j^0 + p_j^1 + \cdots + p_j^{\alpha_j}, \quad g[m] = p_j^0 + p_j^1 + \cdots + p_j^{\alpha_j+1} \]  
\[ f[i] = g[i] \times \cdots, \quad f[m] = g[m] \times \cdots \]
äºæ˜¯
\[ f[m] = f[i] \times \frac{g[m]}{g[i]} \]

(2) è‹¥ \( i \) ä¸èƒ½è¢« \( p_j \) æ•´é™¤ï¼Œåˆ™ \( i \) ä¸åŒ…å«è´¨å› å­ \( p_j \)ã€‚  
\[ g[m] = 1 + p_j \]  
\[ f[m] = g[m] \times f[i] \]

```cpp
//O(n)æ±‚1-nçš„çº¦æ•°å’Œ
vector<int> sumd()
{
    vector<int> g(n+1),f(n+1);
    vector<int> primes;
    vector<bool>v(n+1,0);
    g[1]=f[1]=1;
    for(int i=2;i<=n;i++)
    {
        if(!v[i])
        {
            primes.push_back(i);
            f[i]=g[i]=i+1;
        }
        for(int j=0;j<primes.size()&&primes[j]*i<=n;j++)
        {
            int m=primes[j]*i;
            v[m]=1;
            if(i%primes[j]==0)
            {
                g[m]=g[i]*primes[j]+1;
                f[m]=f[i]*g[m]/g[i];
                break;
            }
            else
            {
                g[m]=primes[j]+1;
                f[m]=f[i]*g[m];
            }
        }
    }
}
```

## å”¯ä¸€åˆ†è§£å®šç†

\[ n = \prod_{i=1}^{s} p_i^{\alpha_i} = p_1^{\alpha_1} p_2^{\alpha_2} \cdots p_s^{\alpha_s} \]

---

## è«æ¯”ä¹Œæ–¯å‡½æ•°å®šä¹‰

è«æ¯”ä¹Œæ–¯å‡½æ•°è®°ä½œ $\mu(n)$ï¼Œå®ƒæ˜¯ä¸€ä¸ªç»å…¸çš„æ•°è®ºå‡½æ•°ï¼Œå®šä¹‰å¦‚ä¸‹ï¼š

- $\mu(1) = 1$

- å¦‚æœ $n$ å«æœ‰å¹³æ–¹å› å­ï¼ˆå³å­˜åœ¨æŸä¸ªè´¨æ•° $p$ï¼Œä½¿å¾— $p^2 \mid n$ï¼‰ï¼Œåˆ™ $\mu(n) = 0$

- å¦‚æœ $n$ æ˜¯ $k$ ä¸ª**äº’ä¸ç›¸åŒçš„è´¨æ•°**çš„ä¹˜ç§¯ï¼ˆå³ $n = p_1 p_2 \cdots p_k$ï¼‰ï¼Œåˆ™ï¼š

$$
\mu(n) = (-1)^k
$$

---



## ç­›æ³•æ±‚è«æ¯”ä¹Œæ–¯å‡½æ•°

è‹¥ \(i\) æ˜¯è´¨æ•°ï¼Œ\(\mu[i] = -1\)ã€‚  
åœ¨çº¿æ€§ç­›ä¸­ï¼Œæ¯ä¸ªåˆæ•° \(m\) éƒ½æ˜¯è¢«æœ€å°çš„è´¨å› å­ç­›æ‰çš„ã€‚  
è®¾ \(p_j\) æ˜¯ \(m\) çš„æœ€å°è´¨å› å­ï¼Œåˆ™ \(m\) é€šè¿‡ \(m = i \times p_j\) ç­›æ‰ã€‚  

(1) è‹¥ \(i\) èƒ½è¢« \(p_j\) æ•´é™¤ï¼Œåˆ™ \(i\) ä¹ŸåŒ…å«è´¨å› å­ \(p_j\)ã€‚  
\[ \mu[m] = 0 \]

(2) è‹¥ \(i\) ä¸èƒ½è¢« \(p_j\) æ•´é™¤ï¼Œåˆ™ \(m\) æ¯” \(i\) å¤šä¸€ä¸ªä¸åŒçš„è´¨å› å­ \(p_j\)  
- è‹¥ \(\mu[i] = -1\), åˆ™ \(\mu[m] = 1\)  
- è‹¥ \(\mu[i] = 1\), åˆ™ \(\mu[m] = -1\)  
- è‹¥ \(\mu[i] = 0\), åˆ™ \(\mu[m] = 0\)  
ç»¼ä¸Šï¼Œ\(\mu[m] = -\mu[i]\)ã€‚


# çº¿æ€§é€†å…ƒ

**O(n)æ±‚é˜¶ä¹˜å’Œé˜¶ä¹˜é€†å…ƒ**
## ğŸ“˜ æ¨å¯¼ç›®æ ‡

ç»™å®šè´¨æ•° $p$ï¼Œæˆ‘ä»¬å¸Œæœ›åœ¨çº¿æ€§æ—¶é—´å†…è®¡ç®— $1$ åˆ° $n$ çš„æ‰€æœ‰æ•°åœ¨æ¨¡ $p$ æ„ä¹‰ä¸‹çš„ä¹˜æ³•é€†å…ƒï¼Œå³ï¼š  
$$
\text{æ±‚ } \forall 1 \le i \le n, \quad \text{ä½¿å¾— } r_i \cdot i \equiv 1 \pmod{p} \text{ çš„ } r_i
$$

---

## ğŸ§® æ¨å¯¼å…¬å¼

æˆ‘ä»¬è®¾ $r_i = i^{-1} \bmod p$ï¼Œæœ‰ï¼š
- $r_1 = 1$
- å¯¹äº $i > 1$ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨å¦‚ä¸‹é€’æ¨å¼æ±‚å‡º $r_i$ï¼š

\[
r_i = (p - \left\lfloor \frac{p}{i} \right\rfloor) \cdot r_{p \bmod i} \bmod p
\]

---

## âœï¸ è¯æ˜è¿‡ç¨‹



è€ƒè™‘ï¼š

$$
p = i \cdot \left\lfloor \frac{p}{i} \right\rfloor + (p \bmod i) \Rightarrow p \bmod i = p - i \cdot \left\lfloor \frac{p}{i} \right\rfloor
$$

ä¸¤è¾¹æ¨¡p:

$$
i \cdot \left( \left\lfloor \frac{p}{i} \right\rfloor \right) \equiv - (p \bmod i) \pmod{p}
\Rightarrow i \cdot \left( \left\lfloor \frac{p}{i} \right\rfloor \right) \cdot (p \bmod i)^{-1} \equiv -1 \pmod{p}
$$

ä¸¤è¾¹éƒ½ä¹˜ä¸Š $-1$ï¼š

$$
i \cdot \left( -\left\lfloor \frac{p}{i} \right\rfloor \right) \cdot (p \bmod i)^{-1} \equiv 1 \pmod{p}
$$

äºæ˜¯æˆ‘ä»¬å¾—å‡ºï¼š

$$
\boxed{
\text{inv}[i] \equiv - \left( \left\lfloor \frac{p}{i} \right\rfloor \right) \cdot \text{inv}[p \bmod i] \pmod{p}
}
$$

å†åŒ–ç®€æˆ**æ— è´Ÿæ•°å½¢å¼**ï¼š

$$
\boxed{
\text{inv}[i] = (p - p / i) \cdot \text{inv}[p \% i] \bmod p
}
$$

è¿™å°±æ˜¯æˆ‘ä»¬è¦ç”¨çš„é€’æ¨å¼ï¼


---

## ğŸ§ª C++ å®ç°ç¤ºä¾‹

```cpp
void preC()
{
    inv[1]=1;
    for(int i=2;i<=n;i++)
    {
        inv[i]=(mod-mod/i)*inv[mod%i]%mod;
    }
    fac[0]=invfac[0]=1;
    for(int i=1;i<=n;i++)
    {
        fac[i]=fac[i-1]*i%mod;
        invfac[i]=invfac[i-1]*inv[i]%mod;
    }
}
```

---

## ğŸ§  æ—¶é—´å¤æ‚åº¦

- æ—¶é—´ï¼š$\mathcal{O}(n)$
- ç©ºé—´ï¼š$\mathcal{O}(n)$
- è¦æ±‚ $p$ æ˜¯è´¨æ•°ï¼ˆå¦åˆ™ä¸å­˜åœ¨ä¹˜æ³•é€†å…ƒï¼‰

# å’Œå¼å˜æ¢
# å’Œå¼å˜æ¢è§„åˆ™ä¸æŠ€æœ¯

## åŸºæœ¬å˜æ¢è§„åˆ™
1. **åˆ†é…å¾‹**  
   \[
   \sum_{k \in K} c a_k = c \sum_{k \in K} a_k
   \]
   
2. **ç»“åˆå¾‹**  
   \[
   \sum_{k \in K} (a_k + b_k) = \sum_{k \in K} a_k + \sum_{k \in K} b_k
   \]
   
3. **äº¤æ¢å¾‹**  
   \[
   \sum_{k \in K} a_k = \sum_{p(k) \in K} a_{p(k)}
   \]
   å…¶ä¸­ $p(k)$ æ˜¯æŒ‡æ ‡é›†çš„ä»»æ„æ’åˆ—  
   **ç¤ºä¾‹**ï¼š  
   $a_1 + a_2 + a_3 + a_6 = a_6 + a_3 + a_2 + a_1$

---

## é«˜çº§å˜æ¢æŠ€æœ¯
### 1. æ›¿æ¢æ¡ä»¶å¼
\[
\sum_{i=1}^{n} \sum_{j=1}^{m} \sum_{d|\gcd(i,j)} d = 
\sum_{i=1}^{n} \sum_{j=1}^{m} \sum_{d=1}^{\min(n,m)} [d|i][d|j] d
\]
### 2. æ›¿æ¢æŒ‡æ ‡å˜é‡
\[
\sum_{i=1}^{n} \sum_{j=1}^{m} [\gcd(i,j) = k] = 
\sum_{i'=1}^{\lfloor n/k \rfloor} \sum_{j'=1}^{\lfloor m/k \rfloor} [\gcd(i',j') = 1]
\]
å…¶ä¸­ $i' = i/k, j' = j/k$

### 3. äº¤æ¢æ±‚å’Œæ¬¡åº
\[
\sum_{i=1}^{n} \sum_{j=1}^{m} A(i)B(j) = 
\sum_{j=1}^{m} \sum_{i=1}^{n} A(i)B(j)
\]

### 4. åˆ†ç¦»å˜é‡
\[
\sum_{i=1}^{n} \sum_{j=1}^{m} A(i)B(j) = 
\left( \sum_{i=1}^{n} A(i) \right) \left( \sum_{j=1}^{m} B(j) \right)
\]

## æŠ€å·§
### 1. åŒºé—´æ•´é™¤æ¡ä»¶å¼çš„å°é—­å½¢å¼
\[
\sum_{i=1}^{n} [k|i]=\lfloor \frac{n}{k} \rfloor
\]
æ‰©å±•
\[
\lfloor \frac{\lfloor \frac{n}{k} \rfloor}{m} \rfloor=\lfloor \frac{n}{km} \rfloor
\]
>äººè¯ï¼šåœ¨1åˆ°nçš„æ•´æ•°ä¸­ï¼Œèƒ½è¢«kæ•´é™¤çš„æ•°çš„ä¸ªæ•°æ˜¯ $\lfloor \frac{n}{k} \rfloor$

### 2. $[gcd(i,j)=1]$çš„è¿›ä¸€æ­¥å˜æ¢
\[
\sum_{i=1}^{n} \sum_{j=1}^{m} [\gcd(i,j)=1] = \sum_{i=1}^{n} \sum_{j=1}^{m} \sum_{d|\gcd(i,j)} \mu(d)
\]
\[
   = \sum_{i=1}^{n} \sum_{j=1}^{m} \sum_{d=1}^{\min(n,m)} \mu(d) [d|i][d|j]
\]
>äººè¯ï¼šå˜æ¢æšä¸¾é¡ºåºï¼Œdèƒ½æ•´é™¤iå’Œjï¼Œåˆ™dèƒ½æ•´é™¤gcd(i,j)

### 3. æœ‰åºå¯¹å’Œæ— åºå¯¹æ±‚å’Œçš„äº’ç›¸è½¬æ¢
\[
\sum_{i=1}^{n} \sum_{j=1}^{n} A(i,j) = 2*\sum_{i=1}^{n} \sum_{j=i}^{n} A(i,j) - \sum_{i=1}^{n} A(i,i)
\]
å½“ä¸”ä»…å½“ $A(i,j) = A(j,i)$ æ—¶æˆç«‹
>äººè¯ï¼šå°†æœ‰åºå¯¹è½¬æ¢ä¸ºæ— åºå¯¹ï¼Œæ³¨æ„æšä¸¾é¡ºåº
### 4. é€šè¿‡$gcd(i,j)=1$æ„é€ æ¡ä»¶å¼$[gcd(i,j)=1]$
ä»¤
\[
   d=\gcd(i,j),i=i'd, j=j'd
\]
æ³¨æ„ï¼Œå½“ä¸”ä»…å½“
\[
   \gcd(i',j')=1
\]
æ—¶ï¼Œæ­¤å˜æ¢æˆç«‹ï¼Œäºæ˜¯
\[
\sum_{i=1}^{n} \sum_{j=1}^{m} f(\gcd(i,j)) 
\]
\[
= \sum_{d=1}^{\min(n,m)} \sum_{i'd=1}^{n} \sum_{j'd=1}^{m} f(d) [\gcd(i',j')=1]
\]
\[
= \sum_{d=1}^{\min(n,m)} \sum_{i'=1}^{\lfloor n/d \rfloor} \sum_{j'=1}^{\lfloor m/d \rfloor} f(d) [\gcd(i',j')=1]
\]
å˜é‡æ¢å
\[
= \sum_{d=1}^{\min(n,m)} \sum_{i=1}^{\lfloor n/d \rfloor} \sum_{j=1}^{\lfloor m/d \rfloor} f(d) [\gcd(i,j)=1]
\]
>äººè¯ï¼šæ²¡æœ‰äººè¯


# ç”Ÿæˆå‡½æ•°

åºåˆ— $a$ çš„æ™®é€šç”Ÿæˆå‡½æ•°ï¼ˆordinary generating functionï¼ŒOGFï¼‰å®šä¹‰ä¸ºå½¢å¼å¹‚çº§æ•°ï¼ˆå…¶å®å°±æ˜¯ä¸€ä¸ªå¤šé¡¹å¼()ï¼‰ï¼š

$$
F(x)=\sum_{n}a_n x^n
$$

$a$ æ—¢å¯ä»¥æ˜¯æœ‰ç©·åºåˆ—ï¼Œä¹Ÿå¯ä»¥æ˜¯æ— ç©·åºåˆ—ã€‚å¸¸è§çš„ä¾‹å­ï¼ˆå‡è®¾ $a$ ä»¥ $0$ ä¸ºèµ·ç‚¹ï¼‰ï¼š

1.  åºåˆ— $a=\langle 1,2,3\rangle$ çš„æ™®é€šç”Ÿæˆå‡½æ•°æ˜¯ $1+2x+3x^2$ã€‚
2.  åºåˆ— $a=\langle 1,1,1,\cdots\rangle$ çš„æ™®é€šç”Ÿæˆå‡½æ•°æ˜¯ $\sum_{n\ge 0}x^n$ã€‚
3.  åºåˆ— $a=\langle 1,2,4,8,16,\cdots\rangle$ çš„ç”Ÿæˆå‡½æ•°æ˜¯ $\sum_{n\ge 0}2^nx^n$ã€‚
4.  åºåˆ— $a=\langle 1,3,5,7,9,\cdots\rangle$ çš„ç”Ÿæˆå‡½æ•°æ˜¯ $\sum_{n\ge 0}(2n+1)x^n$ã€‚

æ¢å¥è¯è¯´ï¼Œå¦‚æœåºåˆ— $a$ æœ‰é€šé¡¹å…¬å¼ï¼Œé‚£ä¹ˆå®ƒçš„æ™®é€šç”Ÿæˆå‡½æ•°çš„ç³»æ•°å°±æ˜¯é€šé¡¹å…¬å¼ã€‚

## åŸºæœ¬è¿ç®—

è€ƒè™‘ä¸¤ä¸ªåºåˆ— $a,b$ çš„æ™®é€šç”Ÿæˆå‡½æ•°ï¼Œåˆ†åˆ«ä¸º $F(x),G(x)$ã€‚é‚£ä¹ˆæœ‰

$$
F(x)\pm G(x)=\sum_n (a_n\pm b_n)x^n
$$

å› æ­¤ $F(x)\pm G(x)$ æ˜¯åºåˆ— $\langle a_n\pm b_n\rangle$ çš„æ™®é€šç”Ÿæˆå‡½æ•°ã€‚

è€ƒè™‘ä¹˜æ³•è¿ç®—ï¼Œä¹Ÿå°±æ˜¯å·ç§¯ï¼š

$$
F(x)G(x)=\sum_n x^n \sum_{i=0}^na_ib_{n-i}
$$

å› æ­¤ $F(x)G(x)$ æ˜¯åºåˆ— $\langle \sum_{i=0}^n a_ib_{n-i} \rangle$ çš„æ™®é€šç”Ÿæˆå‡½æ•°ã€‚

## å°é—­å½¢å¼

åœ¨è¿ç”¨ç”Ÿæˆå‡½æ•°çš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬ä¸ä¼šä¸€ç›´ä½¿ç”¨å½¢å¼å¹‚çº§æ•°çš„å½¢å¼ï¼Œè€Œä¼šé€‚æ—¶åœ°è½¬åŒ–ä¸ºå°é—­å½¢å¼ä»¥æ›´å¥½åœ°åŒ–ç®€ã€‚

ä¾‹å¦‚ $\langle 1,1,1,\cdots\rangle$ çš„æ™®é€šç”Ÿæˆå‡½æ•° $F(x)=\sum_{n\ge 0}x^n$ï¼Œæˆ‘ä»¬å¯ä»¥å‘ç°

$$
F(x)x+1=F(x)
$$

é‚£ä¹ˆè§£è¿™ä¸ªæ–¹ç¨‹å¾—åˆ°

$$
F(x)=\frac{1}{1-x}
$$

è¿™å°±æ˜¯ $\sum_{n\ge 0}x^n$ çš„å°é—­å½¢å¼ã€‚

è€ƒè™‘ç­‰æ¯”æ•°åˆ— $\langle 1,p,p^2,p^3,p^4,\cdots\rangle$ çš„ç”Ÿæˆå‡½æ•° $F(x)=\sum_{n\ge 0}p^nx^n$ï¼Œæœ‰

$$
\begin{aligned}F(x)px+1 &=F(x)\\F(x) &=\frac{1}{1-px}\end{aligned}
$$

ç­‰æ¯”æ•°åˆ—çš„å°é—­å½¢å¼ä¸å±•å¼€å½¢å¼æ˜¯å¸¸ç”¨çš„å˜æ¢æ‰‹æ®µã€‚


## åº”ç”¨

æ¥ä¸‹æ¥ç»™å‡ºä¸€äº›ä¾‹é¢˜ï¼Œæ¥ä»‹ç»ç”Ÿæˆå‡½æ•°åœ¨ OI ä¸­çš„å…·ä½“åº”ç”¨ã€‚

##### æ™®é€šç”Ÿæˆå‡½æ•°å¯ä»¥ç”¨æ¥è§£å†³**å¤šé‡é›†åˆç»„åˆæ•°**é—®é¢˜ã€‚

---

 é—®é¢˜ï¼šæœ‰ $n$ ç§ç‰©å“ï¼Œæ¯ç§ç‰©å“æœ‰ $a_i$ ä¸ªï¼Œé—®å– $m$ ä¸ªç‰©å“çš„ç»„åˆæ•°ï¼Ÿ

---

### å¤šé‡é›†åˆç»„åˆæ•°

è®¾ä»æ¯ç§ç‰©å“ä¸­å– $b_i$ ä¸ªï¼Œ$0 \le b_i \le a_i$ï¼Œ  
$m = \sum_{i=1}^{n} b_i$ï¼Œå¯¹äºä¸€ç»„é€‰å®šçš„ $b_i$ è¿›è¡Œç»„åˆçš„æ–¹æ¡ˆæ•°ä¸º **1**ã€‚  
ä¾‹å¦‚ï¼Œå– 3 ä¸ª Aï¼Œ1 ä¸ª B çš„æ–¹æ¡ˆå°±æ˜¯ {AAAB}ï¼›å– 2 ä¸ª Aã€2 ä¸ª B çš„æ–¹æ¡ˆå°±æ˜¯ {AABB}ã€‚  
é‚£ä¹ˆï¼Œæ‰€æœ‰æ»¡è¶³  
_**bâ‚ + bâ‚‚ + â‹¯ + bâ‚™ = m**_ çš„æ–¹æ¡ˆä¹‹å’Œï¼Œå³ç­”æ¡ˆã€‚

---

### æ„é€ æ™®é€šç”Ÿæˆå‡½æ•°

ç¬¬ 1 ç§ç‰©å“çš„ç”Ÿæˆå‡½æ•°ä¸º $(1 + x^1 + x^2 + â‹¯ + x^{a_1})$ï¼Œ  
ç¬¬ $n$ ç§ç‰©å“çš„ç”Ÿæˆå‡½æ•°ä¸º $(1 + x^1 + x^2 + â‹¯ + x^{a_n})$ã€‚  

å³  
$$(1 + x^1 + x^2 + â‹¯ + x^{a_1})(1 + x^1 + x^2 + â‹¯ + x^{a_2}) â‹¯ (1 + x^1 + x^2 + â‹¯ + x^{a_n})$$  
æ±‚ $x^m$ çš„ç³»æ•°ã€‚

> **æ³¨æ„ï¼š** æŒ‡æ•°å³ç‰©å“ä¸ªæ•°ï¼Œç³»æ•°å³ç»„åˆæ•°ã€‚

---

### ä¾‹å¦‚ï¼š

æœ‰ä¸‰ç§ç‰©å“ï¼Œåˆ†åˆ«æœ‰ 3ã€2ã€1 ä¸ªï¼Œé—®å– 4 ä¸ªç‰©å“çš„ç»„åˆæ•°ï¼Ÿ  
æšä¸¾çš„è¯ï¼Œæœ‰ {AAAB, AAAC, AABB, AABC, ABBC}ï¼Œ5 ä¸ªæ–¹æ¡ˆã€‚

æ„é€   
$$(1 + x + x^2 + x^3)(1 + x + x^2)(1 + x)$$  

é€æ­¥å±•å¼€ï¼š

```math
= (1 + x + x^2 + x^3)(1 + x + x^2)(1 + x) \\
= (1 + x + x^2 + x^3 + x^2 + x^3 + x^4 + x^3 + x^4 + x^5)(1 + x) \\
= (1 + 2x + 3x^2 + 3x^3 + 3x^4 + 2x^5 + x^6)(1 + x) \\
= 1 + 3x + 5x^2 + 6x^3 + 5x^4 + 3x^5 + x^6
```

$x^4$ çš„ç³»æ•°ä¸º 5ï¼Œå³ç­”æ¡ˆã€‚

### HDU - 1085 Holding Bin-Laden Captive!

é¢å€¼ä¸º 1, 2, 5 çš„ç¡¬å¸åˆ†åˆ«æœ‰ $a_1, a_2, a_3$ æšï¼Œ  
é—®ç”¨è¿™äº›ç¡¬å¸**ä¸èƒ½**ç»„æˆçš„æœ€å°é¢å€¼æ˜¯å¤šå°‘ï¼Ÿ

---

### æ€è·¯

æ„é€ ç”Ÿæˆå‡½æ•°ï¼š

$$(1 + x^1 + x^2 + \cdots + x^{a_1}) \times (1 + x^2 + x^4 + \cdots + x^{2a_2}) \times (1 + x^5 + x^{10} + \cdots + x^{5a_3})$$

ä»å°åˆ°å¤§éå†ç³»æ•°ï¼Œ**ä¸º 0 çš„é‚£ä¸€é¡¹**å°±æ˜¯ç­”æ¡ˆã€‚

---

### ä¾‹å¦‚ï¼š

1 åˆ†æœ‰ 1 æšï¼Œ2 åˆ†æœ‰ 1 æšï¼Œ5 åˆ†æœ‰ 1 æšï¼š

```math
(1 + x^1)(1 + x^2)(1 + x^5) \\
= (1 + x^2 + x^1 + x^3)(1 + x^5) \\
= (1 + x^1 + x^2 + x^3)(1 + x^5) \\
= (1 + x^5 + x^1 + x^6 + x^2 + x^7 + x^3 + x^8) \\
= 1 + x^1 + x^2 + x^3 + x^5 + x^6 + x^7 + x^8
```

æœ€å°ä¸èƒ½ç»„æˆçš„é¢å€¼æ˜¯ 4ã€‚

### é£Ÿç‰©
    åœ¨è®¸å¤šä¸åŒç§ç±»çš„é£Ÿç‰©ä¸­é€‰å‡º $n$ ä¸ªï¼Œæ¯ç§é£Ÿç‰©çš„é™åˆ¶å¦‚ä¸‹ï¼š
    
    1.  æ‰¿å¾·æ±‰å ¡ï¼šå¶æ•°ä¸ª
    2.  å¯ä¹ï¼š0 ä¸ªæˆ– 1 ä¸ª
    3.  é¸¡è…¿ï¼š0 ä¸ªï¼Œ1 ä¸ªæˆ– 2 ä¸ª
    4.  èœœæ¡ƒå¤šï¼šå¥‡æ•°ä¸ª
    5.  é¸¡å—ï¼š4 çš„å€æ•°ä¸ª
    6.  åŒ…å­ï¼š0 ä¸ªï¼Œ1 ä¸ªï¼Œ2 ä¸ªæˆ– 3 ä¸ª
    7.  åœŸè±†ç‰‡ç‚’è‚‰ï¼šä¸è¶…è¿‡ä¸€ä¸ªã€‚
    8.  é¢åŒ…ï¼š3 çš„å€æ•°ä¸ª
    
    æ¯ç§é£Ÿç‰©éƒ½æ˜¯ä»¥ã€Œä¸ªã€ä¸ºå•ä½ï¼Œåªè¦æ€»æ•°åŠ èµ·æ¥æ˜¯ n å°±ç®—ä¸€ç§æ–¹æ¡ˆã€‚å¯¹äºç»™å‡ºçš„ n ä½ éœ€è¦è®¡ç®—å‡ºæ–¹æ¡ˆæ•°ï¼Œå¯¹ 10007 å–æ¨¡ã€‚

è¿™æ˜¯ä¸€é“ç»å…¸çš„ç”Ÿæˆå‡½æ•°é¢˜ã€‚å¯¹äºä¸€ç§é£Ÿç‰©ï¼Œæˆ‘ä»¬å¯ä»¥è®¾ $a_n$ è¡¨ç¤ºè¿™ç§é£Ÿç‰©é€‰ $n$ ä¸ªçš„æ–¹æ¡ˆæ•°ï¼Œå¹¶æ±‚å‡ºå®ƒçš„ç”Ÿæˆå‡½æ•°ã€‚è€Œä¸¤ç§é£Ÿç‰©ä¸€å…±é€‰ $n$ ä¸ªçš„æ–¹æ¡ˆæ•°çš„ç”Ÿæˆå‡½æ•°ï¼Œå°±æ˜¯å®ƒä»¬ç”Ÿæˆå‡½æ•°çš„å·ç§¯ã€‚å¤šç§é£Ÿç‰©é€‰ $n$ ä¸ªçš„æ–¹æ¡ˆæ•°çš„ç”Ÿæˆå‡½æ•°ä¹Ÿæ˜¯å®ƒä»¬ç”Ÿæˆå‡½æ•°çš„å·ç§¯ã€‚

åœ¨ç†è§£äº†æ–¹æ¡ˆæ•°å¯ä»¥ç”¨å·ç§¯è¡¨ç¤ºä»¥åï¼Œæˆ‘ä»¬å°±å¯ä»¥æ„é€ ç”Ÿæˆå‡½æ•°ï¼ˆæ ‡å·å¯¹åº”é¢˜ç›®ä¸­é£Ÿç‰©çš„æ ‡å·ï¼‰ï¼š

1.  $\displaystyle\sum_{n\ge 0}x^{2n}=\dfrac{1}{1-x^2}$ã€‚
2.  $1+x$ã€‚
3.  $1+x+x^2=\dfrac{1-x^3}{1-x}$ã€‚
4.  $\displaystyle\sum_{n\ge 0}x^{2n+1}=\displaystyle\sum_{n\ge 0}x^{n}-\displaystyle\sum_{n\ge 0}x^{2n}=\dfrac{x}{1-x^2}$ã€‚
5.  $\displaystyle \sum_{n\ge 0}x^{4n}=\dfrac{1}{1-x^4}$ã€‚
6.  $1+x+x^2+x^3=\dfrac{1-x^4}{1-x}$ã€‚
7.  $1+x$ã€‚
8.  $\displaystyle\sum_{n\ge 0}x^{3n}=\dfrac{1}{1-x^3}$ã€‚

é‚£ä¹ˆå…¨éƒ¨ä¹˜èµ·æ¥ï¼Œå¾—åˆ°ç­”æ¡ˆçš„ç”Ÿæˆå‡½æ•°ï¼š

$$
F(x)=\frac{(1+x)(1-x^3)x(1-x^4)(1+x)}{(1-x^2)(1-x)(1-x^2)(1-x^4)(1-x)(1-x^3)}
=\frac{x}{(1-x)^4}
$$

**å¹¿ä¹‰äºŒé¡¹å¼å®šç†**
\[
\frac{1}{(1-x)^n} = \sum_{i=0}^\infty C_{n+i-1}^i x^i
\]

ç„¶åå°†å®ƒè½¬åŒ–ä¸ºå±•å¼€å½¢å¼ï¼ˆä½¿ç”¨å¹¿ä¹‰äºŒé¡¹å¼å®šç†ï¼‰ï¼š


$$
\begin{aligned}
F(x) &= x \sum_{i=0}^{\infty} \left( C_{4+i-1}^{i} \right) x^i \\
&= \sum_{i=0}^{\infty} \left( C_{4+i-1}^{i} \right) x^{i+1} \\
&= \sum_{k=1}^{\infty} \left( C_{k+2}^{k-1}\right) x^k \\
&= \sum_{k=1}^{\infty} \left( C_{k+2}^{3}\right) x^k
\end{aligned}
$$

å› æ­¤ç­”æ¡ˆä¸º 

$$
 C_{n+2}^{3}
$$

## æŒ‡æ•°ç”Ÿæˆå‡½æ•°
æŒ‡æ•°ç”Ÿæˆå‡½æ•°ï¼š

\[ F(x) = \sum_{n\geq 0} a_n \frac{x^n}{n!} \]


åºåˆ— \( <1,1,1,\cdots> \) çš„æŒ‡æ•°ç”Ÿæˆå‡½æ•°æ˜¯ 
\[ 1 + \frac{x}{1!} + \frac{x^2}{2!} + \frac{x^3}{3!} + \cdots = \sum_{n\geq 0} \frac{x^n}{n!} = e^{x} \]

åºåˆ— \( <1,p,p^2,\cdots> \) çš„æŒ‡æ•°ç”Ÿæˆå‡½æ•°æ˜¯ 
\[ 1 + p \frac{x}{1!} + p^2 \frac{x^2}{2!} + p^3 \frac{x^3}{3!} + \cdots = \sum_{n\geq 0} p^n \frac{x^n}{n!} = e^{px} \]

### åŸºæœ¬è¿ç®—

åŠ å‡è¿ç®—

\[F(x) \pm G(x) = \sum_{i\geq 0} a_i \frac{x^i}{i!} \pm \sum_{j\geq 0} b_j \frac{x^j}{j!} = \sum_{n\geq 0} (a_n \pm b_n) \frac{x^n}{n!}\]

å› æ­¤ \( F(x) \pm G(x) \) æ˜¯åºåˆ— \( <a_n \pm b_n> \) çš„æŒ‡æ•°ç”Ÿæˆå‡½æ•°ã€‚

ä¹˜æ³•è¿ç®—ï¼ˆå·ç§¯ï¼‰

\[F(x)G(x) = \sum_{i\geq 0} a_i \frac{x^i}{i!} \sum_{j\geq 0} b_j \frac{x^j}{j!} = \sum_{n\geq 0} x^n \sum_{i=0}^n a_i b_{n-i} \frac{1}{i!(n-i)!} = \sum_{n\geq 0} \frac{x^n}{n!} \sum_{i=0}^n \frac{n!}{i!(n-i)!} a_i b_{n-i} = \sum_{n\geq 0} \frac{x^n}{n!} \sum_{i=0}^n C_n^i a_i b_{n-i}\]

å› æ­¤ \( F(x)G(x) \) æ˜¯åºåˆ— \( <\sum_{i=0}^n C_n^i a_i b_{n-i}> \) çš„æŒ‡æ•°ç”Ÿæˆå‡½æ•°ã€‚

### å°é—­å½¢å¼

æˆ‘ä»¬åŒæ ·è€ƒè™‘æŒ‡æ•°ç”Ÿæˆå‡½æ•°çš„å°é—­å½¢å¼ã€‚

åºåˆ— $\langle 1,1,1,\cdots\rangle$ çš„æŒ‡æ•°ç”Ÿæˆå‡½æ•°æ˜¯ï¼š

$$
\hat{F}(x) = \sum_{n \ge 0}\frac{x^n}{n!} = \mathrm{e}^x
$$

å› ä¸ºä½ å°† $\mathrm{e}^x$ åœ¨ $x = 0$ å¤„æ³°å‹’å±•å¼€å°±å¾—åˆ°äº†å®ƒçš„æ— ç©·çº§æ•°å½¢å¼ã€‚

ç±»ä¼¼åœ°ï¼Œç­‰æ¯”æ•°åˆ— $\langle 1,p,p^2,\cdots\rangle$ çš„æŒ‡æ•°ç”Ÿæˆå‡½æ•°æ˜¯ï¼š

$$
\hat{F}(x) = \sum_{n\ge 0}\frac{p^nx^n}{n!}=\mathrm{e}^{px}
$$

### æŒ‡æ•°ç”Ÿæˆå‡½æ•°å¯ä»¥ç”¨æ¥è§£å†³å¤šé‡é›†æ’åˆ—æ•°é—®é¢˜ã€‚

HDU - 1521 æ’åˆ—ç»„åˆ
é¢˜æ„ï¼šæœ‰ \( n \) ç§ç‰©å“ï¼Œæ¯ç§ç‰©å“æœ‰ \( a_i \) ä¸ªï¼Œé—®å– \( m \) ä¸ªç‰©å“çš„æ’åˆ—æ•°ï¼Ÿ

å¤šé‡é›†æ’åˆ—æ•°
è®¾ä»æ¯ç§ç‰©å“ä¸­å– \( b_i \) ä¸ªï¼Œ\( 0 \leq b_i \leq a_i \)ï¼Œ\( m = \sum_{i=1}^n b_i \)ï¼Œå¯¹äºä¸€ç»„é€‰å®šçš„ \( b_i \) è¿›è¡Œæ’åˆ—çš„æ–¹æ¡ˆæ•°ä¸º \(\frac{m!}{b_1!b_2!\cdots b_n!}\)ã€‚è‹¥ \( m \) ä¸ªç‰©å“äº’ä¸ç›¸åŒï¼Œå…¶æ’åˆ—æ•°ä¸º \( m! \)ï¼Œåˆ†æ¯å°±æ˜¯å¯¹æ¯ç§ç›¸åŒç‰©å“çš„æ’åˆ—æ•°å»é‡ã€‚
ä¾‹å¦‚ï¼Œå–3ä¸ªAã€1ä¸ªBçš„æ’åˆ—æ•°ä¸º \(\frac{4!}{3!1!} = \frac{24}{6} = 4\)ï¼Œå³ {AAAA, AABA, ABAA, BAAA}ã€‚

å–2ä¸ªAã€2ä¸ªBçš„æ’åˆ—æ•°ä¸º \(\frac{4!}{2!2!} = \frac{24}{4} = 6\)ï¼Œå³ {AABB, ABAB, ABBA, BAAB. BABA, BBAA}ã€‚
é‚£ä¹ˆï¼Œæ‰€æœ‰æ»¡è¶³ \( b_1 + b_2 + \cdots + b_n = m \) çš„æ’åˆ—æ•°ä¹‹å’Œï¼Œå³ç­”æ¡ˆã€‚

æ„é€ æŒ‡æ•°ç”Ÿæˆå‡½æ•°
ç¬¬1ç§ç‰©å“çš„ç”Ÿæˆå‡½æ•°ä¸º \((1 + \frac{x^1}{1!} + \frac{x^2}{2!} + \cdots + \frac{x^{a_1}}{a_1!})\)ï¼Œç¬¬nç§ç‰©å“çš„ç”Ÿæˆå‡½æ•°ä¸º \((1 + \frac{x^1}{1!} + \frac{x^2}{2!} + \cdots + \frac{x^{a_n}}{a_n!})\)ã€‚
å³ \((1 + \frac{x^1}{1!} + \frac{x^2}{2!} + \cdots + \frac{x^{a_1}}{a_1!})(1 + \frac{x^1}{1!} + \frac{x^2}{2!} + \cdots + \frac{x^{a_2}}{a_2!})\cdots(1 + \frac{x^1}{1!} + \frac{x^2}{2!} + \cdots + \frac{x^{a_n}}{a_n!})\)ï¼Œæ±‚ \(\frac{x^m}{m!}\) çš„ç³»æ•°ã€‚

åšä¹˜æ³•ï¼Œ\(\frac{x^{b_1}}{b_1!} \times \frac{x^{b_2}}{b_2!} \times \cdots \times \frac{x^{b_n}}{b_n!} = \frac{x^{b_1+b_2+\cdots+b_n}}{b_1!b_2!\cdots b_n!} = \frac{x^m}{b_1!b_2!\cdots b_n!} = \frac{m!}{b_1!b_2!\cdots b_n!} \cdot \frac{x^m}{m!}\)ã€‚
åšå·ç§¯ï¼Œæ‰€æœ‰æ»¡è¶³ \( b_1 + b_2 + \cdots + b_n = m \) çš„é¡¹çš„ç³»æ•°ä¹‹å’Œï¼Œå†ä¹˜ä»¥ \( m! \)ï¼Œå³ç­”æ¡ˆã€‚

## ä¸€ç‚¹å°ç»“è®ºï¼ˆå‰å·²è¿°åŠï¼‰

(1) åºåˆ— \( a \) çš„æ™®é€šç”Ÿæˆå‡½æ•°ï¼š\( F(x) = \sum a_n x^n \)

(2) åºåˆ— \( a \) çš„æŒ‡æ•°ç”Ÿæˆå‡½æ•°ï¼š\( F(x) = \sum a_n \frac{x^n}{n!} \)

---

**æ³°å‹’å±•å¼€å¼**

æ™®é€šç”Ÿæˆå‡½æ•°ï¼š
\[
\frac{1}{1-x} = 1 + x + x^2 + x^3 + \cdots = \sum_{n=0}^\infty x^n
\]
\[
\frac{1}{1-x^2} = 1 + x^2 + x^4 + \cdots
\]
\[
\frac{1}{1-x^3} = 1 + x^3 + x^6 + \cdots
\]
\[
\frac{1}{(1-x)^2} = 1 + 2x + 3x^2 + \cdots
\]

æŒ‡æ•°ç”Ÿæˆå‡½æ•°ï¼š
\[
e^x = 1 + \frac{x^1}{1!} + \frac{x^2}{2!} + \frac{x^3}{3!} + \cdots = \sum_{n=0}^\infty \frac{x^n}{n!}
\]
\[
e^{-x} = 1 - \frac{x^1}{1!} + \frac{x^2}{2!} - \frac{x^3}{3!} + \cdots
\]
\[
\frac{e^{x} + e^{-x}}{2} = 1 + \frac{x^2}{2!} + \frac{x^4}{4!} + \cdots
\]
\[
\frac{e^{x} - e^{-x}}{2} = x + \frac{x^3}{3!} + \frac{x^5}{5!} + \cdots
\]

---

**æœ‰ç©·åºåˆ—çš„ç”Ÿæˆå‡½æ•°**
\[
1 + x + x^2 = \frac{1-x^3}{1-x}
\]
\[
1 + x + x^2 + x^3 = \frac{1-x^4}{1-x}
\]

---

**å¹¿ä¹‰äºŒé¡¹å¼å®šç†**
\[
\frac{1}{(1-x)^n} = \sum_{i=0}^\infty C_{n+i-1}^i x^i
\]

**è¯æ˜ï¼š**

äºŒé¡¹å¼å®šç†ï¼š
\[
(1+x)^n = \sum_{i=0}^n C_n^i x^i
\]

(1) æ‰©å±•åŸŸï¼š
\[
(1+x)^n = \sum_{i=0}^\infty C_n^i x^i, \quad \text{å½“ } i > n \text{ æ—¶ } C_n^i = 0
\]

(2) æ‰©å±•æŒ‡æ•°ä¸ºè´Ÿæ•°ï¼š
\[
C_{-n}^i = (-n)(-n-1)\cdots(-n-i+1)
\]
\[
= (-1)^i \cdot \frac{n(n+1)\cdots(n+i-1)}{i!} = (-1)^i C_{n+i-1}^i
\]
\[
(1+x)^{-n} = \sum_{i=0}^\infty C_{-n}^i x^i
\]
\[
= \sum_{i=0}^\infty (-1)^i C_{n+i-1}^i x^i
\]

(3) æ‹¬å·å†…çš„åŠ å·å˜å‡å·ï¼š
\[
(1-x)^{-n} = \sum_{i=0}^\infty (-1)^i C_{n+i-1}^i (-x)^i
\]
\[
= \sum_{i=0}^\infty C_{n+i-1}^i x^i
\]

è¯æ¯•ã€‚

# è«å

### ç‹„åˆ©å…‹é›·ç”Ÿæˆå‡½æ•°

æ•°åˆ— $\langle a_1, a_2, a_3, \cdots \rangle$ çš„ç‹„åˆ©å…‹é›·ç”Ÿæˆå‡½æ•°å®šä¹‰ä¸ºï¼š
$$
F(x) = \frac{a_1}{1^x} + \frac{a_2}{2^x} + \frac{a_3}{3^x} + \cdots = \sum_{n=1}^{\infty} \frac{a_n}{n^x}
$$

---

#### ä¹˜æ³•è¿ç®—ï¼ˆDirichlet å·ç§¯ï¼‰
$$
\begin{aligned}
\sum_{i=1}^{\infty} \frac{a_i}{i^x} \sum_{j=1}^{\infty} \frac{b_j}{j^x}
&= \left( \frac{a_1}{1^x} + \frac{a_2}{2^x} + \frac{a_3}{3^x} + \frac{a_4}{4^x} + \cdots \right) \left( \frac{b_1}{1^x} + \frac{b_2}{2^x} + \frac{b_3}{3^x} + \frac{b_4}{4^x} + \cdots \right) \\
&= \frac{a_1 b_1}{1^x} + \frac{a_1 b_2}{2^x} + \frac{a_2 b_1}{3^x} + \frac{a_1 b_3}{4^x} + \cdots \\
&= \sum_{n=1}^{\infty} \frac{1}{n^x} \sum_{d|n} a_d b_\frac{n}{d}
\end{aligned}
$$

#### ç³»æ•°è®¡ç®—è§„åˆ™
$\frac{1}{n^x}$ é¡¹çš„ç³»æ•°ç­‰äºæ‰€æœ‰æ»¡è¶³ $d|n$ï¼ˆ$d$ æ•´é™¤ $n$ï¼‰çš„é¡¹ $a_d b_{n/d}$ ä¹‹å’Œï¼š
- **$4^x$ çš„ç³»æ•°**ï¼š$a_1 b_4 + a_2 b_2 + a_4 b_1$  
  ï¼ˆæšä¸¾ 4 çš„çº¦æ•° $d=1,2,4$ï¼‰
- **$6^x$ çš„ç³»æ•°**ï¼š$a_1 b_6 + a_2 b_3 + a_3 b_2 + a_6 b_1$  
  ï¼ˆæšä¸¾ 6 çš„çº¦æ•° $d=1,2,3,6$ï¼‰

### ä¸€ç‚¹å’Œå¼çš„å°ç»“è®º

# æ¬§æ‹‰å‡½æ•°

## 1. å®šä¹‰
æ¬§æ‹‰å‡½æ•° $\varphi(n)$ è¡¨ç¤ºå°äºç­‰äº $n$ ä¸”ä¸ $n$ äº’è´¨çš„æ­£æ•´æ•°ä¸ªæ•°ï¼š
$$
\varphi(n) = \sum_{i=1}^n [\gcd(i,n) = 1]
$$

### æ¬§æ‹‰å‡½æ•°å€¼è¡¨
| $n$   | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 | 10 | 11 | 12 |
|-------|---|---|---|---|---|---|---|---|---|---|----|----|
| $\varphi(n)$ | 1 | 1 | 2 | 2 | 4 | 2 | 6 | 4 | 6 | 4  | 10 | 4  |

## 2. æ€§è´¨
### æ¬§æ‹‰å‡½æ•°æ±‚å’Œå®šç†
å¯¹äºä»»æ„æ­£æ•´æ•° $n$ï¼Œå…¶æ‰€æœ‰å› å­çš„æ¬§æ‹‰å‡½æ•°å€¼ä¹‹å’Œç­‰äº $n$ï¼š
$$
\sum_{d|n} \varphi(d) = n
$$

### éªŒè¯ç¤ºä¾‹
$$
\begin{aligned}
\varphi(1) &= 1 \\
\varphi(1) + \varphi(2) &= 1 + 1 = 2 \\
\varphi(1) + \varphi(3) &= 1 + 2 = 3 \\
\varphi(1) + \varphi(2) + \varphi(4) &= 1 + 1 + 2 = 4 \\
\varphi(1) + \varphi(5) &= 1 + 4 = 5 \\
\varphi(1) + \varphi(2) + \varphi(3) + \varphi(6) &= 1 + 1 + 2 + 2 = 6
\end{aligned}
$$



## è¯æ˜æ€è·¯
è€ƒè™‘ä»¥ $n$ ä¸ºåˆ†æ¯çš„çœŸåˆ†æ•° $\left[0,1\right)$ åŒºé—´ï¼š
$$
\frac{0}{n}, \frac{1}{n}, \frac{2}{n}, \cdots, \frac{n-1}{n}
$$
å°†è¿™äº›åˆ†æ•°åŒ–ç®€ä¸ºæœ€ç®€å½¢å¼åï¼Œæ ¹æ®åˆ†æ¯åˆ†ç»„ï¼Œå¯è¯æ˜ç»“è®ºã€‚

---

## ç¤ºä¾‹æ¼”ç¤ºï¼ˆ$n=12$ï¼‰
### æ‰€æœ‰çœŸåˆ†æ•°
$$
\frac{0}{12}, \frac{1}{12}, \frac{2}{12}, \frac{3}{12}, \frac{4}{12}, \frac{5}{12}, \frac{6}{12}, \frac{7}{12}, \frac{8}{12}, \frac{9}{12}, \frac{10}{12}, \frac{11}{12}
$$

### åŒ–ç®€ååˆ†ç»„
| åˆ†æ¯ $d$ | æœ€ç®€åˆ†æ•°                                                                 | ä¸ªæ•° $\varphi(d)$ |
|---------|--------------------------------------------------------------------------|------------------|
| 1       | $\dfrac{0}{1}$                                                           | $\varphi(1)=1$  |
| 2       | $\dfrac{1}{2}$                                                           | $\varphi(2)=1$  |
| 3       | $\dfrac{1}{3},\dfrac{2}{3}$                                              | $\varphi(3)=2$  |
| 4       | $\dfrac{1}{4},\dfrac{3}{4}$                                              | $\varphi(4)=2$  |
| 6       | $\dfrac{1}{6},\dfrac{5}{6}$                                              | $\varphi(6)=2$  |
| 12      | $\dfrac{1}{12},\dfrac{5}{12},\dfrac{7}{12},\dfrac{11}{12}$               | $\varphi(12)=4$ |

### éªŒè¯ç­‰å¼
$$
\sum_{d|12}\varphi(d) = \varphi(1)+\varphi(2)+\varphi(3)+\varphi(4)+\varphi(6)+\varphi(12) = 1+1+2+2+2+4=12
$$

---
æ³¨æ„åˆ°çªä»¬çš„è¯æ˜æ€è·¯å¤©ç„¶æ»¡è¶³å®šä¹‰

## ä¸€èˆ¬æ€§è¯æ˜
1. è€ƒè™‘æ‰€æœ‰åˆ†æ¯ä¸º $n$ çš„çœŸåˆ†æ•°ï¼š
   $$
   \frac{k}{n} \quad (0 \leq k < n)
   $$
   å…±æœ‰ $n$ ä¸ªåˆ†æ•°ã€‚

2. å°†æ¯ä¸ªåˆ†æ•°åŒ–ç®€ä¸ºæœ€ç®€å½¢å¼ $\dfrac{a}{d}$ï¼Œå…¶ä¸­ $d \mid n$ ä¸” $\gcd(a,d)=1$ã€‚

3. å¯¹ $n$ çš„æ¯ä¸ªçº¦æ•° $d$ åˆ†ç»„ï¼š
   - åˆ†æ¯ä¸º $d$ çš„åˆ†æ•°ä¸ªæ•° = $\varphi(d)$
   - å› ä¸ºåˆ†å­ $a$ éœ€æ»¡è¶³ $1 \leq a \leq d$ ä¸” $\gcd(a,d)=1$

4. æ€»å’Œä¸ºï¼š
   $$
   \sum_{d|n} \varphi(d) = n
   $$
   å³å¾—è¯ã€‚

# è«æ¯”ä¹Œæ–¯å‡½æ•°

## 1. å®šä¹‰
è«æ¯”ä¹Œæ–¯å‡½æ•° $\mu(n)$ å®šä¹‰å¦‚ä¸‹ï¼š
$$
\mu(n) = 
\begin{cases} 
1 & \text{è‹¥ } n = 1 \\ 
(-1)^s & \text{è‹¥ } n = p_1p_2 \cdots p_s \text{ï¼ˆæ— å¹³æ–¹å› å­çš„æ•´æ•°ï¼‰} \\ 
0 & \text{è‹¥ } n \text{ åŒ…å«å¹³æ–¹å› å­}
\end{cases}
$$

### è«æ¯”ä¹Œæ–¯å‡½æ•°å€¼è¡¨
| $n$   | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 | 10 | 11 | 12 |
|-------|---|---|---|---|---|---|---|---|---|---|----|----|
| $\mu(n)$ | 1 | -1 | -1 | 0 | -1 | 1 | -1 | 0 | 0 | 1  | -1 | 0  |

---

## 2. æ ¸å¿ƒæ€§è´¨
$$
\sum_{d|n} \mu(d) = [n = 1] = 
\begin{cases} 
1 & n=1 \\
0 & n>1 
\end{cases}
$$

### éªŒè¯ç¤ºä¾‹
$$
\begin{aligned}
n=1:&\quad \mu(1) = 1 \\
n=2:&\quad \mu(1) + \mu(2) = 1 + (-1) = 0 \\
n=3:&\quad \mu(1) + \mu(3) = 1 + (-1) = 0 \\
n=4:&\quad \mu(1) + \mu(2) + \mu(4) = 1 + (-1) + 0 = 0 \\
n=6:&\quad \mu(1) + \mu(2) + \mu(3) + \mu(6) = 1 + (-1) + (-1) + 1 = 0
\end{aligned}
$$

---

## 3. è¯æ˜ï¼ˆ$n>1$ æ—¶å’Œä¸º 0ï¼‰

### è¯æ˜æ€è·¯
è®¾ $n = p_1^{a_1}p_2^{a_2} \cdots p_s^{a_s}$ï¼Œå®šä¹‰ $n'$ ä¸º $n$ çš„å¹³æ–¹è‡ªç”±éƒ¨åˆ†ï¼š
$$
n' = p_1p_2 \cdots p_s
$$
åˆ™ï¼š
$$
\sum_{d|n} \mu(d) = \sum_{d|n'} \mu(d)
$$

### ç»„åˆè¯æ˜
è€ƒè™‘ $n$ çš„è´¨å› å­é›†åˆ $S$ï¼Œå…¶å¤§å°ä¸º $s$ï¼š
- $\mu(d) \neq 0$ çš„ $d$ å¯¹åº” $S$ çš„å­é›†
- $d$ çš„è´¨å› å­ä¸ªæ•°ä¸º $k$ æ—¶ï¼Œ$\mu(d) = (-1)^k$
- ç”±äºŒé¡¹å¼å®šç†

$$
\sum_{d|n'} \mu(d) = \sum_{k=0}^s (-1)^k \binom{s}{k} = (1+(-1))^s = 0
$$

### ç¤ºä¾‹è¯´æ˜ï¼ˆ$n=6$ï¼‰
$6 = 2^1 \times 3^1$ï¼Œ$S = \{2,3\}$ï¼š
$$
\begin{aligned}
\mu(1) &= (-1)^0 = 1 \quad & (\text{å– 0 ä¸ªè´¨å› å­}) \\
\mu(2) &= (-1)^1 = -1 \quad & (\text{å–è´¨å› å­ }2) \\
\mu(3) &= (-1)^1 = -1 \quad & (\text{å–è´¨å› å­ }3) \\
\mu(6) &= (-1)^2 = 1 \quad & (\text{å–è´¨å› å­ }2,3)
\end{aligned}
$$
å’Œä¸º $1 + (-1) + (-1) + 1 = 0$ã€‚




# ç‹„åˆ©å…‹é›·å·ç§¯

## å®šä¹‰
è®¾ $f(n)$, $g(n)$ æ˜¯ä¸¤ä¸ªç§¯æ€§å‡½æ•°ï¼Œå…¶ç‹„åˆ©å…‹é›·å·ç§¯å®šä¹‰ä¸ºï¼š
$$
(f * g)(n) = \sum_{d|n} f(d)g\left(\frac{n}{d}\right) = \sum_{d|n} f\left(\frac{n}{d}\right)g(d)
$$

>æ³¨æ„è·Ÿç‹„åˆ©å…‹é›·ç”Ÿæˆå‡½æ•°å½¢å¼ä¸Šçš„ç›¸ä¼¼æ€§
>è¯»ä½œï¼š$f$ å· $g$ 

### ç¤ºä¾‹
$$
(f * g)(4) = f(1)g(4) + f(2)g(2) + f(4)g(1)
$$

---

## è¿ç®—è§„å¾‹
1. **äº¤æ¢å¾‹**ï¼š$f * g = g * f$  
2. **ç»“åˆå¾‹**ï¼š$(f * g) * h = f * (g * h)$  
3. **åˆ†é…å¾‹**ï¼š$(f + g) * h = f * h + g * h$  

---

## å¸¸ç”¨å‡½æ•°
| å‡½æ•°åç§° | ç¬¦å·è¡¨ç¤º | å®šä¹‰ |
|---------|----------|------|
| å…ƒå‡½æ•° | $\epsilon(n)$ | $[n=1] = \begin{cases} 1 & n=1 \\ 0 & n>1 \end{cases}$ |
| å¸¸æ•°å‡½æ•° | $1(n)$ | $1$ |
| æ’ç­‰å‡½æ•° | $id(n)$ | $n$ |
| æ¬§æ‹‰å‡½æ•° | $\varphi(n)$ |  <nä¸”ä¸näº’è´¨çš„æ•°çš„ä¸ªæ•° |
| è«æ¯”ä¹Œæ–¯å‡½æ•° | $\mu(n)$ |  $\begin{cases} 1 & n=1 \\ (-1)^k & n=p_1p_2...p_k \\ 0 & nå«å¹³æ–¹å› å­ \end{cases}$ |

---

>æ³¨æ„ç¬¦å·çš„è¯»æ³• $\mu$ è¯»ä½œâ€œç¼ªâ€ï¼Œ$\varphi$ è¯»ä½œâ€œphiâ€ï¼Œ$\epsilon$ è¯»ä½œâ€œä¸€ç©†è¥¿éš†â€

## å¸¸ç”¨å·ç§¯å…³ç³»

ç®€è®°å½¢å¼
1. $\sum_{d|n} \mu(d) = [n = 1] \quad \Leftrightarrow \quad \mu * 1 = \epsilon$  
2. $\sum_{d|n} \varphi(d) = n \quad \Leftrightarrow \quad \varphi * 1 = id$  
3. $\sum_{d|n} \mu(d) \frac{n}{d} = \varphi(n) \quad \Leftrightarrow \quad \mu * id = \varphi$  
4. $f * \epsilon = f$  
5. $f * 1 \neq f$

---

>æ³¨æ„è«æ¯”ä¹Œæ–¯å‡½æ•°æ˜¯å¸¸æ•°å‡½æ•°çš„é€†å…ƒ

## è¯æ˜
### 1. $\mu * 1 = \epsilon$
$$
(\mu * 1)(n) = \sum_{d|n} \mu(d) \cdot 1\left(\frac{n}{d}\right) = \sum_{d|n} \mu(d) = [n = 1] = \epsilon(n)
$$

### 2. $\varphi * 1 = id$
$$
(\varphi * 1)(n) = \sum_{d|n} \varphi(d) \cdot 1\left(\frac{n}{d}\right) = \sum_{d|n} \varphi(d) = n = id(n)
$$

### 3. $\mu * id = \varphi$
$$
(\mu * id)(n) = \sum_{d|n} \mu(d) \cdot id\left(\frac{n}{d}\right) = \sum_{d|n} \mu(d) \cdot \frac{n}{d} = \varphi(n)
$$

$$
\mu * id =\mu *\varphi *1 =(\varphi *1 * \mu) = \epsilon * \mu = \varphi
$$

### 4. $f * \epsilon = f$
$$
(f * \epsilon)(n) = \sum_{d|n} f(d) \cdot \epsilon\left(\frac{n}{d}\right) = \sum_{d|n} f(d) \cdot \left[\frac{n}{d} = 1\right] = f(n)
$$

### 5. $f * 1 \neq f$
$$
(f * 1)(n) = \sum_{d|n} f(d) \cdot 1\left(\frac{n}{d}\right) = \sum_{d|n} f(d) \neq f(n)
$$

# è«æ¯”ä¹Œæ–¯åæ¼”

å…¶å®å°±æ˜¯ä¸€ä¸‹å‡ ä¸ªå¼å­(æ¡ä»¶å¼å˜æˆå’Œå¼)
$$
\sum_{d|n} \varphi(d) = n
$$

$$
\sum_{d|n} \mu(d) = [n = 1] = 
\begin{cases} 
1 & n=1 \\
0 & n>1 
\end{cases}
$$

æŠŠ$n$æ¢æˆ$gcd(a,b)$


$$
\sum_{d|gcd(a,b)} \mu(d) = [gcd(a,b) = 1]
\begin{cases} 
1 & gcd(a,b)=1 \\
0 & gcd(a,b)>1 
\end{cases}
$$


# è«æ¯”ä¹Œæ–¯å˜æ¢

## åŸºæœ¬å…¬å¼
è®¾ $f(n)$, $g(n)$ å‡ä¸ºç§¯æ€§å‡½æ•°ï¼Œåˆ™ï¼š
$$
f(n) = \sum_{d|n} g(d) \iff g(n) = \sum_{d|n} \mu(d) f\left(\frac{n}{d}\right)
$$

å³
$$
f=g * 1 \iff g = \mu * f
$$

- $f(n)$ ç§°ä¸º $g(n)$ çš„è«æ¯”ä¹Œæ–¯å˜æ¢
- $g(n)$ ç§°ä¸º $f(n)$ çš„è«æ¯”ä¹Œæ–¯é€†å˜æ¢

---

>æ³¨æ„å¯¹äºä¸€äº›å‡½æ•° f(n)ï¼Œå¦‚æœå¾ˆéš¾ç›´æ¥æ±‚å‡ºå®ƒçš„å€¼ï¼Œè€Œå®¹æ˜“æ±‚å‡ºå…¶å€æ•°å’Œæˆ–çº¦æ•°å’Œ g(n)ï¼Œé‚£ä¹ˆå¯ä»¥é€šè¿‡è«æ¯”ä¹Œæ–¯åæ¼”ç®€åŒ–è¿ç®—ï¼Œæ±‚å¾— 
f(n) çš„å€¼ã€‚

## è¯æ˜æ–¹æ³•ä¸€ï¼ˆå·ç§¯å½¢å¼ï¼‰
### æ­£å‘æ¨å¯¼
$$
\begin{aligned}
f &= g * 1 \\
\mu * f &= \mu * (g * 1) \\
&= g * (\mu * 1) \\
&= g * \epsilon \\
&= g
\end{aligned}
$$

### é€†å‘æ¨å¯¼
$$
\begin{aligned}
g &= \mu * f \\
g * 1 &= (\mu * f) * 1 \\
&= f * (\mu * 1) \\
&= f * \epsilon \\
&= f
\end{aligned}
$$

---

## è¯æ˜æ–¹æ³•äºŒï¼ˆåŒé‡æ±‚å’Œï¼‰
$$
\begin{aligned}
\sum_{d|n} \mu(d) f\left(\frac{n}{d}\right) 
&= \sum_{d|n} \mu(d) \sum_{k|\frac{n}{d}} g(k) \\
&= \sum_{d|n} \sum_{k|\frac{n}{d}} \mu(d) g(k) \\
&= \sum_{k|n} \sum_{d|\frac{n}{k}} \mu(d) g(k) \\
&= \sum_{k|n} g(k) \left( \sum_{d|\frac{n}{k}} \mu(d) \right) \\
&= \sum_{k|n} g(k) \cdot \epsilon\left(\frac{n}{k}\right) \\
&= g(n)
\end{aligned}
$$








