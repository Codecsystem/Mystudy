**O(n)æ±‚é˜¶ä¹˜å’Œé˜¶ä¹˜é€†å…ƒ**
## ğŸ“˜ æ¨å¯¼ç›®æ ‡

ç»™å®šè´¨æ•° $p$ï¼Œæˆ‘ä»¬å¸Œæœ›åœ¨çº¿æ€§æ—¶é—´å†…è®¡ç®— $1$ åˆ° $n$ çš„æ‰€æœ‰æ•°åœ¨æ¨¡ $p$ æ„ä¹‰ä¸‹çš„ä¹˜æ³•é€†å…ƒï¼Œå³ï¼š  
$$
\text{æ±‚ } \forall 1 \le i \le n, \quad \text{ä½¿å¾— } r_i \cdot i \equiv 1 \pmod{p} \text{ çš„ } r_i
$$

---

## ğŸ§® æ¨å¯¼å…¬å¼

æˆ‘ä»¬è®¾ $r_i = i^{-1} \bmod p$ï¼Œæœ‰ï¼š
- $r_1 = 1$
- å¯¹äº $i > 1$ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨å¦‚ä¸‹é€’æ¨å¼æ±‚å‡º $r_i$ï¼š

\[
r_i = (p - \left\lfloor \frac{p}{i} \right\rfloor) \cdot r_{p \bmod i} \bmod p
\]

---

## âœï¸ è¯æ˜è¿‡ç¨‹



è€ƒè™‘ï¼š

$$
p = i \cdot \left\lfloor \frac{p}{i} \right\rfloor + (p \bmod i) \Rightarrow p \bmod i = p - i \cdot \left\lfloor \frac{p}{i} \right\rfloor
$$

ä¸¤è¾¹æ¨¡p:

$$
i \cdot \left( \left\lfloor \frac{p}{i} \right\rfloor \right) \equiv - (p \bmod i) \pmod{p}
\Rightarrow i \cdot \left( \left\lfloor \frac{p}{i} \right\rfloor \right) \cdot (p \bmod i)^{-1} \equiv -1 \pmod{p}
$$

ä¸¤è¾¹éƒ½ä¹˜ä¸Š $-1$ï¼š

$$
i \cdot \left( -\left\lfloor \frac{p}{i} \right\rfloor \right) \cdot (p \bmod i)^{-1} \equiv 1 \pmod{p}
$$

äºæ˜¯æˆ‘ä»¬å¾—å‡ºï¼š

$$
\boxed{
\text{inv}[i] \equiv - \left( \left\lfloor \frac{p}{i} \right\rfloor \right) \cdot \text{inv}[p \bmod i] \pmod{p}
}
$$

å†åŒ–ç®€æˆ**æ— è´Ÿæ•°å½¢å¼**ï¼š

$$
\boxed{
\text{inv}[i] = (p - p / i) \cdot \text{inv}[p \% i] \bmod p
}
$$

è¿™å°±æ˜¯æˆ‘ä»¬è¦ç”¨çš„é€’æ¨å¼ï¼


---

## ğŸ§ª C++ å®ç°ç¤ºä¾‹

```cpp
void preC()
{
    inv[1]=1;
    for(int i=2;i<=n;i++)
    {
        inv[i]=(mod-mod/i)*inv[mod%i]%mod;
    }
    fac[0]=invfac[0]=1;
    for(int i=1;i<=n;i++)
    {
        fac[i]=fac[i-1]*i%mod;
        invfac[i]=invfac[i-1]*inv[i]%mod;
    }
}
```

---

## ğŸ§  æ—¶é—´å¤æ‚åº¦

- æ—¶é—´ï¼š$\mathcal{O}(n)$
- ç©ºé—´ï¼š$\mathcal{O}(n)$
- è¦æ±‚ $p$ æ˜¯è´¨æ•°ï¼ˆå¦åˆ™ä¸å­˜åœ¨ä¹˜æ³•é€†å…ƒï¼‰

