# 圆排列

\( n \) 个不同元素围成一圈的**圆排列数**，记作 \( Q_n^n \)。

考虑其中已经排好的一圈，从不同位置断开，会变成 \( n \) 个不同的线排列：  
\[ Q_n^n \times n = A_n^n \]  
则  
\[ Q_n^n = \frac{A_n^n}{n} = (n-1)! \]

例如，3 个不同元素的圆排列数为 \((3-1)! = 2\) 种：

从 \( n \) 个不同元素中选 \( m \) 个围成一圈的**圆排列数**，记作 \( Q_n^m \)：  
\[ 
    Q_n^m = C_n^m \cdot Q_m^m = \frac{n!}{m \cdot (n-m)!}
\]
>其实就是全排列固定了一个数

# 错位排列

错位排列是没有任何元素出现在其有序位置的排列。对于 \(1 \sim n\) 的排列 \(P\)，如果满足 \(P_i \neq i\)，则称 \(P\) 是 \(n\) 的错位排列。

## 错位排列数
- \(D_1 = 0\)
- \(D_2 = 1\)（即 \(\{2,1\}\)）
- \(D_3 = 2\)（即 \(\{2,3,1\},\{3,1,2\}\)）
- \(D_4 = 9\)（即 \(\{2,1,4,3\},\{2,3,4,1\},\{2,4,1,3\},\{3,1,4,2\},\{3,4,1,2\},\{3,4,2,1\},\{4,1,2,3\},\{4,3,1,2\},\{4,3,2,1\}\)）

---

### 递推关系 \(D_n = (n-1)(D_{n-1} + D_{n-2})\)
**边界条件**：
\[
D_1 = 0, \quad D_2 = 1
\]

| \(n\) | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 |
|-------|---|---|---|---|---|---|---|---|
| \(D_n\) | 0 | 1 | 2 | 9 | 44 | 265 | 1854 | 14833 |

---

## 信封问题
\(n\) 封不同的信（编号 \(1,2,\dots,n\)）放入 \(n\) 个编号对应的信封中，要求每个信封的编号与信的编号都不相同。有多少种放置方法？

### 递推关系分析
考虑第 \(n\) 封信的放置：
1. **情况1**：前 \(n-1\) 封信已全错排  
   - 第 \(n\) 封信只需与前面任一封信交换位置  
   - 方法数：\((n-1) \cdot D_{n-1}\)

2. **情况2**：前 \(n-1\) 封信恰好有 1 封位置正确  
   - 第 \(n\) 封信必须与位置正确的信交换  
   - 方法数：\((n-1) \cdot D_{n-2}\)

> 其他情况无法通过一次交换变成全错排

# 第一类斯特林数（斯特林轮换数）

将 \( n \) 个不同元素划分为 \( m \) 个非空圆排列的方案数，  
记作 \( S(n, m) \) 或：
\[
\begin{bmatrix}
n \\
m
\end{bmatrix}
\]

## 递推关系
\[
\begin{bmatrix}
n \\
m
\end{bmatrix} = 
\begin{bmatrix}
n-1 \\
m-1
\end{bmatrix} + (n-1)
\begin{bmatrix}
n-1 \\
m
\end{bmatrix}
\]

---

## 组合解释（圆桌问题）
\( n \) 个人坐 \( m \) 张圆桌的方案数，考虑第 \( n \) 个人的两种坐法：

1. **单独坐一桌**  
   - 前 \( n-1 \) 人坐满剩余的 \( m-1 \) 张桌  
   - 方案数：\(\begin{bmatrix} n-1 \\ m-1 \end{bmatrix}\)

2. **与其他人同坐**  
   - 前 \( n-1 \) 人先坐满 \( m \) 张桌  
   - 第 \( n \) 人可坐到任意 \( n-1 \) 个人的左侧  
   - 方案数：\((n-1) \cdot \begin{bmatrix} n-1 \\ m \end{bmatrix}\)

# 第二类斯特林数（斯特林子集数）

将 \( n \) 个不同元素划分为 \( m \) 个非空子集的方案数，  
记作 \( S(n, m) \) 或：
\[
\left\{ \begin{array}{c} n \\ m \end{array} \right\}
\]

## 递推关系
\[
\left\{ \begin{array}{c} n \\ m \end{array} \right\} = 
\left\{ \begin{array}{c} n-1 \\ m-1 \end{array} \right\} + 
m \left\{ \begin{array}{c} n-1 \\ m \end{array} \right\}
\]

---

## 组合解释（房间分配问题）
\( n \) 个人进入 \( m \) 个房间的方案数（每个房间非空），考虑第 \( n \) 个人的两种选择：

1. **单独进入新房间**  
   - 前 \( n-1 \) 人进入剩余的 \( m-1 \) 个房间  
   - 方案数：\(\left\{ \begin{array}{c} n-1 \\ m-1 \end{array} \right\}\)

2. **进入已有人的房间**  
   - 前 \( n-1 \) 人先进入所有 \( m \) 个房间  
   - 第 \( n \) 人可选择进入任意一个已有人的房间  
   - 方案数：\(m \cdot \left\{ \begin{array}{c} n-1 \\ m \end{array} \right\}\)